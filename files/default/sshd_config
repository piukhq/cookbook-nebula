PermitRootLogin no
Port 22
AddressFamily inet
ListenAddress 0.0.0.0

HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

Protocol 2
StrictModes yes
SyslogFacility AUTH
LogLevel VERBOSE

Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256
KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256

LoginGraceTime 30s
MaxAuthTries 2
MaxSessions 20
MaxStartups 20:30:100

PubkeyAuthentication yes

IgnoreRhosts yes
IgnoreUserKnownHosts yes
HostbasedAuthentication no

AuthenticationMethods publickey

# Disable password-based authentication, it can allow for potentially easier brute-force attacks.
PasswordAuthentication no
PermitEmptyPasswords no
ChallengeResponseAuthentication no

GSSAPIAuthentication no
GSSAPICleanupCredentials yes
KerberosOrLocalPasswd no
KerberosTicketCleanup yes
KerberosAuthentication no
UsePrivilegeSeparation sandbox
UseLogin no

# AllowUsers {{ ssh_allow_users }}

TCPKeepAlive no

ClientAliveInterval 300
ClientAliveCountMax 3

# Nice to haves but not great
PermitTunnel yes
AllowTcpForwarding yes
AllowAgentForwarding yes


GatewayPorts no
X11Forwarding no
X11UseLocalhost yes

PermitUserEnvironment no
Compression yes
UseDNS no
PrintMotd no

PrintLastLog no
Banner none
DebianBanner no

Subsystem sftp internal-sftp -l INFO -f LOCAL6 -u 0027
